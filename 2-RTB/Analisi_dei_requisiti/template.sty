\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{template}[2014/08/21 Example package]

\RequirePackage{enumitem}

\RequirePackage{etoolbox}

%Comando che genera variabile vuota che salva una serie di attori
\newcommand{\listaAttori}{}
%Comando che aggiunge l'attore passato come parametro alla lista
%\newcommand{nomeComando}[n. parametri]}{comportamento}
%\gappto{variabile}{contenuto che viene aggiunto come append alla variabile}
\newcommand{\addAttore}[1]{
    \gappto{\listaAttori}{\item #1}      % #1 si indica la stringa passata come primo parametro
}
%=============================
\newcommand{\listaPreCondizioni}{}
\newcommand{\addPreCondizione}[1]{
    \gappto{\listaPreCondizioni}{\item #1}
}
%=============================
\newcommand{\listaPostCondizioni}{}
\newcommand{\addPostCondizione}[1]{
    \gappto{\listaPostCondizioni}{\item #1}
}
%=============================
\newcommand{\listaTrigger}{}
\newcommand{\addTrigger}[1]{
    \gappto{\listaTrigger}{\item #1}
}
%=============================
\newcommand{\listaScenarioPrincipale}{}
\newcommand{\addScenarioPrincipale}[1]{
    \gappto{\listaScenarioPrincipale}{\item #1}
}
%=============================
\newcommand{\listaInclusioni}{}
\newcommand{\addInclusione}[1]{
    \gappto{\listaInclusioni}{\item #1}
}
%=============================
\newcommand{\listaScenariAlternativi}{}
\newcommand{\addScenarioAlternativo}[1]{
    \gappto{\listaScenariAlternativi}{\item #1}
}
%=============================
\newcommand{\listaEstensioni}{}
\newcommand{\addEstensione}[1]{
    \gappto{\listaEstensioni}{\item #1}
}
%=============================


\newcommand{\makeTable}{
  \begin{center}
    \begin{tabularx}{\textwidth}{|>{\columncolor{lightgray}}c|X|}
      \hline
      % Attori
      \ifdefempty{\listaAttori}{}{
        \textbf{Attori} &
        \begin{itemize}[topsep=0pt, partopsep=0pt, itemsep=0pt, leftmargin=10pt]
          \listaAttori
        \end{itemize} \\ \hline
      }

      % Pre-condizioni
      \ifdefempty{\listaPreCondizioni}{}{
        \textbf{Pre-condizioni} &
        \begin{itemize}[topsep=0pt, partopsep=0pt, itemsep=0pt, leftmargin=10pt]
          \listaPreCondizioni
        \end{itemize} \\ \hline
      }

      % Post-condizioni
      \ifdefempty{\listaPostCondizioni}{}{
        \textbf{Post-condizioni} &
        \begin{itemize}[topsep=0pt, partopsep=0pt, itemsep=0pt, leftmargin=10pt]
          \listaPostCondizioni
        \end{itemize} \\ \hline
      }

      % Trigger
      \ifdefempty{\listaTrigger}{}{
        \textbf{Trigger} &
        \begin{itemize}[topsep=0pt, partopsep=0pt, itemsep=0pt, leftmargin=10pt]
          \listaTrigger
        \end{itemize} \\ \hline
      }

      % Scenario principale
      \ifdefempty{\listaScenarioPrincipale}{}{
        \textbf{Scenario principale} &
        \begin{enumerate}[topsep=0pt, partopsep=0pt, itemsep=0pt, leftmargin=10pt]
          \listaScenarioPrincipale
        \end{enumerate} \\ \hline
      }

      % Inclusioni
      \ifdefempty{\listaInclusioni}{}{
        \textbf{Inclusioni} &
        \begin{itemize}[topsep=0pt, partopsep=0pt, itemsep=0pt, leftmargin=10pt]
          \listaInclusioni
        \end{itemize} \\ \hline
      }

      % Scenari alternativi
      \ifdefempty{\listaScenariAlternativi}{}{
        \textbf{Scenari alternativi} &
        \begin{itemize}[topsep=0pt, partopsep=0pt, itemsep=0pt, leftmargin=10pt]
          \listaScenariAlternativi
        \end{itemize} \\ \hline
      }

      % Estensioni
      \ifdefempty{\listaEstensioni}{}{
        \textbf{Estensioni} &
        \begin{itemize}[topsep=0pt, partopsep=0pt, itemsep=0pt, leftmargin=10pt]
          \listaEstensioni
        \end{itemize} \\ \hline
      }
    \end{tabularx}
  \end{center}

  % Pulisce le variabili per la prossima tabella
  \renewcommand{\listaAttori}{}
  \renewcommand{\listaPreCondizioni}{}
  \renewcommand{\listaPostCondizioni}{}
  \renewcommand{\listaTrigger}{}
  \renewcommand{\listaScenarioPrincipale}{}
  \renewcommand{\listaScenariAlternativi}{}
  \renewcommand{\listaInclusioni}{}
  \renewcommand{\listaEstensioni}{}
}


